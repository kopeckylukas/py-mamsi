
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../tutorials/">
      
      
        <link rel="next" href="../MamsiStructSearch/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>MamsiPls - MAMSI v1.0.5</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="mamsi" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MAMSI v1.0.5" class="md-header__button md-logo" aria-label="MAMSI v1.0.5" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MAMSI v1.0.5
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              MamsiPls
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MAMSI v1.0.5" class="md-nav__button md-logo" aria-label="MAMSI v1.0.5" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    MAMSI v1.0.5
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MAMSI
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API References
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    MamsiPls
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    MamsiPls
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mamsipls" class="md-nav__link">
    <span class="md-ellipsis">
      MamsiPls
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MamsiPls">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#estimate_lv" class="md-nav__link">
    <span class="md-ellipsis">
      .estimate_lv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate_class_model" class="md-nav__link">
    <span class="md-ellipsis">
      .evaluate_class_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate_regression_model" class="md-nav__link">
    <span class="md-ellipsis">
      .evaluate_regression_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kfold_cv" class="md-nav__link">
    <span class="md-ellipsis">
      .kfold_cv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#montecarlo_cv" class="md-nav__link">
    <span class="md-ellipsis">
      .montecarlo_cv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mb_vip" class="md-nav__link">
    <span class="md-ellipsis">
      .mb_vip
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block_importance" class="md-nav__link">
    <span class="md-ellipsis">
      .block_importance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mb_vip_permtest" class="md-nav__link">
    <span class="md-ellipsis">
      .mb_vip_permtest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calculate_ci" class="md-nav__link">
    <span class="md-ellipsis">
      .calculate_ci
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group_train_test_split" class="md-nav__link">
    <span class="md-ellipsis">
      .group_train_test_split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MamsiStructSearch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MamsiStructSearch
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mamsipls" class="md-nav__link">
    <span class="md-ellipsis">
      MamsiPls
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MamsiPls">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#estimate_lv" class="md-nav__link">
    <span class="md-ellipsis">
      .estimate_lv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate_class_model" class="md-nav__link">
    <span class="md-ellipsis">
      .evaluate_class_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate_regression_model" class="md-nav__link">
    <span class="md-ellipsis">
      .evaluate_regression_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kfold_cv" class="md-nav__link">
    <span class="md-ellipsis">
      .kfold_cv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#montecarlo_cv" class="md-nav__link">
    <span class="md-ellipsis">
      .montecarlo_cv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mb_vip" class="md-nav__link">
    <span class="md-ellipsis">
      .mb_vip
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block_importance" class="md-nav__link">
    <span class="md-ellipsis">
      .block_importance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mb_vip_permtest" class="md-nav__link">
    <span class="md-ellipsis">
      .mb_vip_permtest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calculate_ci" class="md-nav__link">
    <span class="md-ellipsis">
      .calculate_ci
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group_train_test_split" class="md-nav__link">
    <span class="md-ellipsis">
      .group_train_test_split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="_1"></h1>
<h2 id="mamsipls">MamsiPls</h2>
<p><a href="https://github.com/kopeckylukas/py-mamsi/blob/main/mamsi/mamsi_pls.py/#L23">source</a>
<div class="highlight"><pre><span></span><code><span class="n">MamsiPls</span><span class="p">(</span>
   <span class="n">n_components</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">full_svd</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;NIPALS&#39;</span><span class="p">,</span> <span class="n">standardize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
   <span class="n">max_tol</span> <span class="o">=</span> <span class="mf">1e-14</span><span class="p">,</span> <span class="n">nipals_convergence_norm</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">calc_all</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">sparse_data</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
   <span class="n">copy</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>A class that extends the MB_PLS class by extra methods convenient in Chemometrics and Metabolomics research. 
It is based on MB-PLS package: Baum et al., (2019). Multiblock PLS: Block dependent prediction modeling for Python.
This wrapper has some extra methods convenient in Chemometrics and Metabolomics research.</p>
<p>For a full list of methods, please refer to the MB-PLS class <a href="https://mbpls.readthedocs.io/en/latest/index.html">documentation</a>.</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>n_components</strong> (int, optional) : A number of Latent Variables (LV). Defaults to 2.</li>
<li><strong>full_svd</strong> (bool, optional) : Whether to use full singular value decomposition when performing the SVD method. 
    Set to False when using very large quadratic matrices (X). Defaults to False.</li>
<li><strong>method</strong> (str, optional) : The method used to derive the model attributes. Options are 'UNIPALS', 'NIPALS', 'SIMPLS', 
    and 'KERNEL'. Defaults to 'NIPALS'.</li>
<li><strong>standardize</strong> (bool, optional) : Whether to standardise the data (Unit-variance scaling). Defaults to True.</li>
<li><strong>max_tol</strong> (float, optional) : Maximum tolerance allowed when using the iterative NIPALS algorithm. Defaults to 1e-14.</li>
<li>
<p><strong>nipals_convergence_norm</strong> (int, optional) : Order of the norm that is used to calculate the difference of 
    the super-score vectors between subsequential iterations of the NIPALS algorithm. 
    Following orders are available:</p>
<table>
<thead>
<tr>
<th>ord</th>
<th>norm for matrices</th>
<th>norm for vectors</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>Frobenius norm</td>
<td>2-norm</td>
</tr>
<tr>
<td>'fro'</td>
<td>Frobenius norm</td>
<td>--</td>
</tr>
<tr>
<td>'nuc'</td>
<td>nuclear norm</td>
<td>--</td>
</tr>
<tr>
<td>inf</td>
<td>max(sum(abs(x), axis=1))</td>
<td>max(abs(x))</td>
</tr>
<tr>
<td>-inf</td>
<td>min(sum(abs(x), axis=1))</td>
<td>min(abs(x))</td>
</tr>
<tr>
<td>0</td>
<td>--</td>
<td>sum(x != 0)</td>
</tr>
<tr>
<td>1</td>
<td>max(sum(abs(x), axis=0))</td>
<td>as below</td>
</tr>
<tr>
<td>-1</td>
<td>min(sum(abs(x), axis=0))</td>
<td>as below</td>
</tr>
<tr>
<td>2</td>
<td>2-norm (largest sing. value)</td>
<td>as below</td>
</tr>
<tr>
<td>-2</td>
<td>smallest singular value</td>
<td>as below</td>
</tr>
<tr>
<td>other</td>
<td>--</td>
<td>sum(abs(x)<strong>ord)</strong>(1./ord)</td>
</tr>
</tbody>
</table>
<p>Defaults to 2.</p>
</li>
<li>
<p><strong>calc_all</strong> (bool, optional) : Whether to calculate all internal attributes for the used method. Some methods do not need
    to calculate all attributes (i.e., scores, weights) to obtain the regression coefficients used for prediction.
    Setting this parameter to False will omit these calculations for efficiency and speed. Defaults to True.</p>
</li>
<li><strong>sparse_data</strong> (bool, optional) : NIPALS is the only algorithm that can handle sparse data using the method of H. Martens
    and Martens (2001) (p. 381). If this parameter is set to True, the method will be forced to NIPALS and sparse data
    is allowed. Without setting this parameter to True, sparse data will not be accepted. Defaults to False.</li>
<li><strong>copy</strong> (bool, optional) : Whether the deflation should be done on a copy. Not using a copy might alter the input data
    and have unforeseeable consequences. Defaults to True.</li>
</ul>
<p><strong>Attributes</strong></p>
<ul>
<li><strong>n_components</strong> (int) : Number of Latent Variables (LV).</li>
<li><strong>Ts_</strong> (array) : (X-Side) super scores [n,k]</li>
<li><strong>T_</strong> (list) : (X-Side) block scores [i][n,k]</li>
<li><strong>W_</strong> (list) : (X-Side) block weights [n][pi,k]</li>
<li><strong>A_</strong> (array) : (X-Side) block importances/super weights [i,k]</li>
<li><strong>A_corrected_</strong> (array) : (X-Side) normalized block importances (see mbpls documentation)</li>
<li><strong>P_</strong> (list, block) : (X-Side) loadings [i][pi,k]</li>
<li><strong>R_</strong> (array) : (X-Side) x_rotations R=W(PTW)-1</li>
<li><strong>explained_var_x_</strong> (list) : (X-Side) explained variance in X per LV [k]</li>
<li><strong>explained_var_xblocks_</strong> (array) : (X-Side) explained variance in each block Xi [i,k]</li>
<li><strong>beta_</strong> (array) : (X-Side) regression vector ùõΩ [p,q]</li>
<li><strong>U_</strong> (array) : (Y-Side) scoresInitialize [n,k]</li>
<li><strong>V_</strong> (array) : (Y-Side) loadings [q,k]</li>
<li><strong>explained_var_y_</strong> (list) : (Y-Side) explained variance in Y [k]</li>
</ul>
<p><strong>Methods:</strong></p>
<h3 id="estimate_lv">.estimate_lv</h3>
<p><a href="https://github.com/kopeckylukas/py-mamsi/blob/main/mamsi/mamsi_pls.py/#L93">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">estimate_lv</span><span class="p">(</span>
   <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_components</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">classification</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;auc&#39;</span><span class="p">,</span>
   <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;kfold&#39;</span><span class="p">,</span> <span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">repeats</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
   <span class="n">plateau_threshold</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">increase_threshold</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">get_scores</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
   <span class="n">savefig</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>A method to estimate the number of latent variables (LVs)/components in the MB-PLS model.
   The method is based on cross-validation (k-fold or Monte Carlo) and combined with an outer loop with increasing number of LVs.
   LV on which the model stabilises corresponds with the optimal number of LVs.</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>x</strong> (array or list['array']) : All blocks of predictors x1, x2, ..., xn. Rows are observations, columns are features/variables.</li>
<li><strong>y</strong> (array) : A 1-dim array of reference values, either continuous or categorical variable.</li>
<li><strong>groups</strong> (array, optional) : If provided, cv iterator variant with non-overlapping groups. 
    Group labels for the samples used while splitting the dataset into train/test set.
    Defaults to None.</li>
<li><strong>max_components</strong> (int, optional) : Maximum number of components for whic LV estimate is calculated. 
    Defaults to 10.</li>
<li><strong>classification</strong> (bool, optional) : Whether to perfrom calssification or regression. Defaults to True.</li>
<li><strong>metric</strong> (str, optional) : Metric to use to estimate the number of LVs; available options: [<code>AUC</code>, <code>precision</code>, <code>recall</code>, <code>f1</code>] for 
    categorical outcome variables and ['q2'] for continuous outcome variable. 
    Defaults to 'auc'.</li>
<li><strong>method</strong> (str, optional) : Corss-validation method. Available options ['kfold', 'montecarlo']. Defaults to 'kfold'.</li>
<li><strong>n_splits</strong> (int, optional) : Number of splits for k-fold cross-validation. Defaults to 5.</li>
<li><strong>repeats</strong> (int, optional) : Number of train-test split repeats from Monte Carlo. Defaults to 100.</li>
<li><strong>test_size</strong> (float, optional) : Test size for Monte Carlo. Defaults to 0.2.</li>
<li><strong>random_state</strong> (int, optional) : Generates a sequence of random splits to control MCCV. Defaults to 42.</li>
<li><strong>plateau_threshold</strong> (float, optional) : Maximum increase for a sequence of LVs to be considered a plateau. 
    Must be non-negative. 
    Defaults to 0.01.</li>
<li><strong>increase_threshold</strong> (float, optional) : Minimum increase to be considered a bend. Must be non-negative.. Defaults to 0.05.</li>
<li><strong>get_scores</strong> (bool, optional) : Whether to retun measured mean scores. Defaults to False.</li>
<li><strong>savefig</strong> (bool, optional) : Whether to save the plot as a figure. If True, argument <code>fname</code> has to be provided. Defaults to False.</li>
<li><strong>n_jobs</strong> (int, optional) : Number of workers (CPU cores) for multiprocessing, -1 utilises all available cores on a system. 
    Defaults to -1.</li>
<li><strong>kwargs</strong>  : Additional keyword arguments to be passed to plt.savefig(), fname required to save .</li>
</ul>
<p><strong>Raises</strong></p>
<ul>
<li><strong>ValueError</strong>  : Incorrect metric for categorical outcome. Allowed values are: 'auc', 'precision', 'recall', 'specificity', 'f1', 'accuracy'.</li>
<li><strong>ValueError</strong>  : Incorrect metric for continuous outcome. Allowed values are: 'q2'.</li>
<li><strong>ValueError</strong>  : Invalid method. Available options are ['kfold', 'montecarlo'].</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>DataFrame</strong>  : Measured mean scores for test and train splits for all components.</li>
</ul>
<h3 id="evaluate_class_model">.evaluate_class_model</h3>
<p><a href="https://github.com/kopeckylukas/py-mamsi/blob/main/mamsi/mamsi_pls.py/#L262">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">evaluate_class_model</span><span class="p">(</span>
   <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Evaluate classification MB-PLS model using a <strong>testing</strong> dataset.</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>x</strong> (array or list[array]) : All blocks of predictors x1, x2, ..., xn. Rows are observations, columns are features/variables.</li>
<li><strong>y</strong> (array) : 1-dim or 2-dim array of reference values - categorical variable.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>array</strong>  : Predicted y variable based on training set predictors.</li>
</ul>
<h3 id="evaluate_regression_model">.evaluate_regression_model</h3>
<p><a href="https://github.com/kopeckylukas/py-mamsi/blob/main/mamsi/mamsi_pls.py/#L303">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">evaluate_regression_model</span><span class="p">(</span>
   <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Evaluate regression MB-PLS model using a <strong>testing</strong> dataset.</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>x</strong> (array or list[array]) : All blocks of predictors x1, x2, ..., xn. Rows are observations, columns are features/variables.</li>
<li><strong>y</strong> (array) : 1-dim or 2-dim array of reference values - continuous variable.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>array</strong>  : Predicted y variable based on training set predictors.</li>
</ul>
<h3 id="kfold_cv">.kfold_cv</h3>
<p><a href="https://github.com/kopeckylukas/py-mamsi/blob/main/mamsi/mamsi_pls.py/#L345">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">kfold_cv</span><span class="p">(</span>
   <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">classification</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">return_train</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
   <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Perform k-fold cross-validation for MB-PLS model.</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>x</strong> (array or list[array]) : All blocks of predictors x1, x2, ..., xn. Rows are observations, columns are features/variables.</li>
<li><strong>y</strong> (array) : 1-dim or 2-dim array of reference values, either continuous or categorical variable.</li>
<li><strong>groups</strong> (array, optional) : Group labels for the samples used while splitting the dataset into train/test set.
    If provided, group k-fold is performed. 
    Defaults to None.</li>
<li><strong>classification</strong> (bool, optional) : Whether the outcome is a categorical variable. Defaults to True.</li>
<li><strong>return_train</strong> (bool, optional) : Whether to return evaluation metrics for training set. Defaults to False.</li>
<li><strong>n_splits</strong> (int, optional) : Number of splits for k-fold cross-validation. Defaults to 5.</li>
<li><strong>n_jobs</strong> (int, optional) : Number of workers (CPU cores) for multiprocessing, -1 utilises all available cores on a system. 
    Defaults to -1.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>DataFrame</strong>  : Evaluation metrics for each k-fold split.
    if return_train is True, returns evaluation metrics for training set as well.</li>
</ul>
<h3 id="montecarlo_cv">.montecarlo_cv</h3>
<p><a href="https://github.com/kopeckylukas/py-mamsi/blob/main/mamsi/mamsi_pls.py/#L513">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">montecarlo_cv</span><span class="p">(</span>
   <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">classification</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">return_train</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
   <span class="n">repeats</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Evaluate MB-PLS model using Monte Carlo Cross-Validation (MCCV).</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>x</strong> (array or list[array]) : All blocks of predictors x1, x2, ..., xn. Rows are observations, columns are featuress.</li>
<li><strong>y</strong> (array) : 1-dim or 2-dim array of reference values - categorical variable.</li>
<li><strong>groups</strong> (array, optional) : Group labels for the samples used while splitting the dataset into train/test set.
    If provided, group-train-test split will be used instead of train-test split for random splits. 
    Defaults to None.</li>
<li><strong>classification</strong> (bool, optional) : Whether the outcome is a categorical variable. Defaults to True.</li>
<li><strong>return_train</strong> (bool, optional) : Whether to return evaluation metrics for training set. Defaults to False.</li>
<li><strong>test_size</strong> (float, optional) : Proportion of the dataset to include in the test split. Defaults to 0.2.</li>
<li><strong>repeats</strong> (int, optional) : Number of MCCV repeats. Defaults to 10.</li>
<li><strong>random_state</strong> (int, optional) : Generates a sequence of random splits to control MCCV. Defaults to 42.</li>
<li><strong>n_jobs</strong> (int, optional) : Number of workers (CPU cores) for multiprocessing, -1 utilises all available cores on a system. 
    Defaults to -1.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>DataFrame</strong>  : Evaluation metrics for each MCCV repeat.
    if return_train is True, returns evaluation metrics for training set as well.</li>
</ul>
<h3 id="mb_vip">.mb_vip</h3>
<p><a href="https://github.com/kopeckylukas/py-mamsi/blob/main/mamsi/mamsi_pls.py/#L682">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">mb_vip</span><span class="p">(</span>
   <span class="n">plot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">get_scores</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">savefig</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Multi-block Variable Importance in Projection (MB-VIP) for multiblock PLS model.</p>
<p>Adaptation of C. Wieder et al., (2024). PathIntegrate, doi: 10.1371/journal.pcbi.1011814.</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>plot</strong> (bool, optional) : Whether to plot MB-VIP scores. Defaults to True.</li>
<li><strong>get_scores</strong> (bool, optional) : Whether to return MB-VIP scores. Defaults to False.</li>
<li><strong>savefig</strong> (bool, optional) : Whether to save the plot as a figure. If True, argument <code>fname</code> has to be provided. 
    Defaults to False.</li>
<li><strong>kwargs</strong>  : Additional keyword arguments to be passed to plt.savefig(), fname required to save .            </li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>array</strong>  : MB-VIP scores.</li>
</ul>
<h3 id="block_importance">.block_importance</h3>
<p><a href="https://github.com/kopeckylukas/py-mamsi/blob/main/mamsi/mamsi_pls.py/#L726">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">block_importance</span><span class="p">(</span>
   <span class="n">block_labels</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">normalised</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">plot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">get_scores</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
   <span class="n">savefig</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Calculate the block importance for each block in the multiblock PLS model and plot the results.</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>block_labels</strong> (list, optional) : List of block names. If block names are not provided or they do not match the number 
    of blocks in the model, the plot will display labels as 'Block 1', 'Block 2', ... 'Block n'. Defaults to None.</li>
<li><strong>normalised</strong> (bool, optional) : Whether to use normalised block importance. For more information see model attribute 
    <a href="">'A_Corrected_'</a>. Defaults to True.</li>
<li><strong>plot</strong> (bool, optional) : Whether to render plot block importance. Defaults to True.</li>
<li><strong>get_scores</strong> (bool, optional) : Whether to return block importance scores. Defaults to False.</li>
<li><strong>savefig</strong> (bool, optional) : Whether to save the plot as a figure. If True, argument <code>fname</code> has to be provided. 
    Defaults to False.</li>
<li><strong>kwargs</strong>  : Additional keyword arguments to be passed to plt.savefig(), fname required to save.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>array</strong>  : Block importance scores.</li>
</ul>
<h3 id="mb_vip_permtest">.mb_vip_permtest</h3>
<p><a href="https://github.com/kopeckylukas/py-mamsi/blob/main/mamsi/mamsi_pls.py/#L817">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">mb_vip_permtest</span><span class="p">(</span>
   <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n_permutations</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">return_scores</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Calculate empirical p-values for each feature by permuting the Y outcome variable <code>n_permutations</code> times and
refitting the model. The p-values for each feature are calculated by counting the number of trials with
MB-VIP greater than or equal to the observed test statistic, and dividing this by <code>n_permutations</code>.</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>x</strong> (array or list[array]) : All blocks of predictors x1, x2, ..., xn. Rows are observations, columns are features/variables.</li>
<li><strong>y</strong> (array) : 1-dim or 2-dim array of reference values, either continuous or categorical variable.</li>
<li><strong>n_permutations</strong> (int, optional) : Number of permutation tests. Defaults to 1000.</li>
<li><strong>return_scores</strong> (bool, optional) : Whether to return MB-VIP scores for each permuted null model. Defaults to False.</li>
<li><strong>n_jobs</strong> (int, optional) : Number of workers (CPU cores) for multiprocessing, -1 utilises all available cores on a system. 
    Defaults to -1.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>array</strong>  : Returns an array of p-values for each feature. If <code>return_scores</code> is True, then a matrix of MB-VIP scores
for each permuted null model is returned as well.</li>
</ul>
<h3 id="calculate_ci">.calculate_ci</h3>
<p><a href="https://github.com/kopeckylukas/py-mamsi/blob/main/mamsi/mamsi_pls.py/#L872">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">calculate_ci</span><span class="p">(</span>
   <span class="n">data</span><span class="p">,</span> <span class="n">ci_level</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">dropna</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Static Method</p>
<p>Calculates mean, margin of error, and confidence interval for each column.</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>data</strong> (pd.DataFrame) : The input DataFrame.</li>
<li><strong>ci_level</strong> (float, optional) : The confidence level (e.g., 0.90, 0.95). Defaults to 0.90.</li>
<li><strong>dropna</strong> (bool, optional) : Whether to drop rows containing NaNs. Defaults to True.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>DataFrame</strong>  : A DataFrame containing the calculated statistics for each column.
            If dropna = False, and a column has less than 2 valid values after
            dropping NaNs specific to that column, all the result values for that
            column will be np.nan.</li>
</ul>
<h3 id="group_train_test_split">.group_train_test_split</h3>
<p><a href="https://github.com/kopeckylukas/py-mamsi/blob/main/mamsi/mamsi_pls.py/#L915">source</a>
<div class="highlight"><pre><span></span><code><span class="o">.</span><span class="n">group_train_test_split</span><span class="p">(</span>
   <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">gropus</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span>
<span class="p">)</span>
</code></pre></div></p>
<hr />
<p>Static Method</p>
<p>Split the data into train and test sets based on the groups. The groups are split into train and test sets
based on the <code>test_size</code> parameter. The function returns the train and test sets for the predictors and the
response variable.</p>
<p><strong>Args</strong></p>
<ul>
<li><strong>x</strong> (array or list[array]) : All blocks of predictors x1, x2, ..., xn. Rows are samples, columns are features.</li>
<li><strong>y</strong> (array) : 1-dim or 2-dim array of reference values, either continuous or categorical variable.</li>
<li><strong>groups</strong> (array, optional) : Group labels for the samples used while splitting the dataset into train/test set. Defaults to None.</li>
<li><strong>test_size</strong> (float, optional) : Proportion of the dataset to include in the test split. Defaults to 0.2.</li>
<li><strong>random_state</strong> (int, optional) : Controls the shuffling applied to the data before applying the split. Defaults to 42.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><strong>tuple</strong>  : x_train, x_test, y_train, y_test</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>