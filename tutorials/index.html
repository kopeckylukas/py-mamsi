
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../references/MamsiPls/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.31">
    
    
      
        <title>Tutorials - MAMSI Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="mamsi" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tutorials-and-supporting-materials" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="MAMSI Docs" class="md-header__button md-logo" aria-label="MAMSI Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MAMSI Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tutorials
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="MAMSI Docs" class="md-nav__button md-logo" aria-label="MAMSI Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    MAMSI Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

      </a>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API References
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../references/MamsiPls/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MamsiPls
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../references/MamsiStructSearch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MamsiStructSearch
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<p><a href="https://opensource.org/licenses/BSD-3-Clause"><img alt="License" src="https://img.shields.io/badge/License-BSD_3--Clause-blue.svg" /></a></p>
<h1 id="tutorials-and-supporting-materials">Tutorials and Supporting Materials</h1>
<p>You can find all MAMSI tutorials by visiting our <a href="https://github.com/kopeckylukas/py-mamsi-tutorials">MAMSI Tutorials</a> repository. </p>
<p>The <code>MamsiPls</code> class inherits from the <code>mbpls</code> package [<a href="../#references">1</a>]. For more information on MB-PLS, please visit <a href="https://mbpls.readthedocs.io/en/latest/index.html">mbpls Documentation</a>.</p>
<h1 id="quickstart-tutorial">Quickstart Tutorial</h1>
<h3 id="load-packages">Load Packages</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">mamsi.mamsi_pls</span> <span class="kn">import</span> <span class="n">MamsiPls</span>
<span class="kn">from</span> <span class="nn">mamsi.mamsi_struct_search</span> <span class="kn">import</span> <span class="n">MamsiStructSearch</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</code></pre></div>
<h3 id="load-sample-data">Load Sample Data</h3>
<p><br> Data used within this quickstart guide originate from the the AddNeuroMed [<a href="../#references">2</a>] cohort - dataset of Alzheimer's disease patients. 
You can download the sample data from this <a href="https://github.com/kopeckylukas/py-mamsi-tutorials/tree/main/sample_data">link</a>.</p>
<div class="highlight"><pre><span></span><code><span class="n">metadata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../sample_data/alz_metadata.csv&#39;</span><span class="p">)</span>
<span class="c1"># The PLS algorithm requires the response variable to be numeric. </span>
<span class="c1"># We will encode the outcome &quot;Gender&quot; (Biological Sex) as 1 for female and 0 for male subjects. </span>
<span class="n">y</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;Gender&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;Female&#39;</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Import LC-MS data</span>
<span class="c1"># Add prefix to the columns names. This will be crucial for interpreting the results later on.</span>
<span class="n">hpos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./sample_data/alz_hpos.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;HPOS_&#39;</span><span class="p">)</span>
<span class="n">lpos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./sample_data/alz_lpos.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;LPOS_&#39;</span><span class="p">)</span>
<span class="n">lneg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./sample_data/alz_lneg.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;LNEG_&#39;</span><span class="p">)</span>
</code></pre></div>
<h3 id="split-data">Split data</h3>
<p>Split the dataset to training and testing subsets. The training subset will be used to fit the model, cross-validation and estimation of the number of latent variables. Then the testing subset will be used as an independent dataset to assess the performance of the model. This will ensure that the model is not over-fitted to the data and that in can predict the outcome of the samples.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Split data in the ratio 90:10 for training and testing respectively.</span>
<span class="n">hpos_train</span><span class="p">,</span> <span class="n">hpos_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">hpos</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="c1"># Use a &#39;random_state&#39; value (seed) for reproducibility of results</span>

<span class="c1"># Split the other two block based on the indices of the hpos block.</span>
<span class="n">lpos_train</span> <span class="o">=</span> <span class="n">lpos</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">hpos_train</span><span class="o">.</span><span class="n">index</span><span class="p">,:]</span>
<span class="n">lneg_train</span> <span class="o">=</span> <span class="n">lneg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">hpos_train</span><span class="o">.</span><span class="n">index</span><span class="p">,:]</span>

<span class="n">lpos_test</span> <span class="o">=</span> <span class="n">lpos</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">hpos_test</span><span class="o">.</span><span class="n">index</span><span class="p">,:]</span>
<span class="n">lneg_test</span> <span class="o">=</span> <span class="n">lneg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">hpos_test</span><span class="o">.</span><span class="n">index</span><span class="p">,:]</span>
</code></pre></div>
<h2 id="fit-basic-model">Fit Basic Model</h2>
<h3 id="fit-mb-pls-model-and-estimate-lvs">Fit MB-PLS Model and Estimate LVs</h3>
<p>Start with fitting a simple model utilising one latent variable. Then run the <code>MamsiPls.estimate_lv()</code> method to estimate the number of latent variables in the model. <code>MamsiPls.estimate_lv()</code> uses k-fold cross-validation (CV). The k-fold CV is repeated k-times corresponding to number of LVs in the most complex model. The lowest possible number of LVs where the model stabilised (model performance did not rise with adding more LVs) was selected as the final model.
<div class="highlight"><pre><span></span><code><span class="n">mamsipls</span> <span class="o">=</span> <span class="n">MamsiPls</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mamsipls</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">hpos_train</span><span class="p">,</span> <span class="n">lpos_train</span><span class="p">,</span> <span class="n">lneg_train</span><span class="p">],</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Estimate the number of latent variables in you model</span>
<span class="n">mamsipls</span><span class="o">.</span><span class="n">estimate_lv</span><span class="p">([</span><span class="n">hpos_train</span><span class="p">,</span> <span class="n">lpos_train</span><span class="p">,</span> <span class="n">lneg_train</span><span class="p">],</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;auc&#39;</span><span class="p">)</span>
</code></pre></div>
<img alt="LV estimation result" src="../images/lv_estimation.png" />
<br>The LV estimation result shows that the model has 6 latent variables/components. Adding more LVs to the model could lead into overfitting </p>
<h3 id="evaluate-final-model">Evaluate Final Model</h3>
<p>We can now evaluate the final model that utilises 6 LVs. Use <code>MamsiPls.evaluate_class_model()</code> to evaluate the final model on an independent <code>'testing'</code> dataset. </p>
<p><div class="highlight"><pre><span></span><code><span class="n">predicted</span> <span class="o">=</span> <span class="n">mamsipls</span><span class="o">.</span><span class="n">evaluate_class_model</span><span class="p">([</span><span class="n">hpos_test</span><span class="p">,</span> <span class="n">lpos_test</span><span class="p">,</span> <span class="n">lneg_test</span><span class="p">],</span> <span class="n">y_test</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
</code></pre></div>
<img alt="Confusion Matrix" src="../images/confusion_matrix.png" /></p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Score</th>
</tr>
</thead>
<tbody>
<tr>
<td>Accuracy</td>
<td>0.966</td>
</tr>
<tr>
<td>Recall</td>
<td>1.0</td>
</tr>
<tr>
<td>Specificity</td>
<td>0.943</td>
</tr>
<tr>
<td>F<sub>1</sub> Score</td>
<td>0.971</td>
</tr>
<tr>
<td>AUC</td>
<td>0.933</td>
</tr>
</tbody>
</table>
<p>If the performance of the final model meet our requirements, we can now estimate the the importance of each feature and it's relationship to the outcome.</p>
<h2 id="estimate-feature-importance">Estimate Feature Importance</h2>
<p>If the performance of the final model meet our requirements, we can now estimate the the importance of each feature and it's relationship to the outcome.</p>
<h3 id="multiblock-variable-importance-in-projection">Multiblock Variable Importance in Projection</h3>
<p>We can visualise the Multiblock Variable Importance in Projection (MB-VIP):
<div class="highlight"><pre><span></span><code><span class="n">mb_vip</span> <span class="o">=</span> <span class="n">mamsipls</span><span class="o">.</span><span class="n">mb_vip</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<img alt="Multiblock VIP" src="../images/mb-vip.png" /></p>
<p>Despite that conventionally features with VIP scores greater than 1 are considered statistically significant, this might not be the most effective cut-off for features importance. Especially in a multiblock model, the block size of each data block play a role to overall importance of each features in the given block. 
We can employ permutation testing to estimate empirical p-values for each variable instead. </p>
<h3 id="permutation-testing">Permutation Testing</h3>
<p>The empirical p-values for <em>i<sup>th</sup></em> feature are calculated be <strong>dividing</strong> the number of MB-VIP scores  of Null model for <em>i<sup>th</sup></em> feature <strong>lower</strong> than the <em>observed</em> MB-VIP score for <em>i<sup>th</sup></em> feature, <strong>over the total number of permutations</strong>.</p>
<p><div class="highlight"><pre><span></span><code><span class="n">p_vals</span><span class="p">,</span> <span class="n">null_vip</span> <span class="o">=</span> <span class="n">mamsipls</span><span class="o">.</span><span class="n">mb_vip_permtest</span><span class="p">([</span><span class="n">hpos</span><span class="p">,</span> <span class="n">lpos</span><span class="p">,</span> <span class="n">lneg</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="n">n_permutations</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">return_scores</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<img alt="Null Models Distribution" src="../images/null_models_distribution.png" /></p>
<p><em>Note that the pre-calculated null_vip file contains MB-VIP scores for first 400 null models (permutations) so the p-value displayed on the plot below does not correspond with the plot itself.</em></p>
<h2 id="interpret-statistically-significant-features">Interpret Statistically Significant Features</h2>
<p><div class="highlight"><pre><span></span><code><span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">hpos</span><span class="p">,</span> <span class="n">lpos</span><span class="p">,</span> <span class="n">lneg</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p_vals</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">selected</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">mask</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</code></pre></div>
Use <code>MamsiStrustSearch</code> to search for structural links within the statistically significant features. <br>
Firstly, all features are split into retention time (<em>RT</em>) windows of 5 seconds intervals, then each RT window is searched for isotopologue signatureâ€™s by searching mass differences of 1.00335 <em>Da</em> between mass-to-charge ratios (<em>m/z</em>) of the features; if two or more features resemble mass isotopologue signature then they are grouped together. This is followed by a search for common adduct signatures. This is achieved by calculating hypothetical neutral masses based on common adducts in electrospray ionisation. If hypothetical neutral masses match for two or more features within a pre-defined tolerance (15 <em>ppm</em>) then these features are grouped together. Overlapping adduct clusters and isotopologues clusters are then merged to form structural clusters. Further, we search cross-assay clusters using [M+H]<sup>+</sup>/[M-H]<sup>-</sup> as link references. Additionally, our structural search tool, that utilises region of interest <a href="https://github.com/phenomecentre/npc-open-lcms">(ROI) files</a> from <a href="https://rdrr.io/bioc/peakPantheR/">peakPantheR</a> [<a href="../#references">4</a>], allows for automated annotation of  some features based on the <em>RT</em> for a given chromatography and m/z.</p>
<h3 id="mamsi-structural-search-tool">MAMSI Structural Search Tool</h3>
<p><div class="highlight"><pre><span></span><code><span class="n">struct</span> <span class="o">=</span> <span class="n">MamsiStructSearch</span><span class="p">(</span><span class="n">rt_win</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ppm</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">struct</span><span class="o">.</span><span class="n">load_lcms</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span>
<span class="n">struct</span><span class="o">.</span><span class="n">get_structural_clusters</span><span class="p">(</span><span class="n">annotate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
Further, use can find correlation clusters
<div class="highlight"><pre><span></span><code><span class="n">struct</span><span class="o">.</span><span class="n">get_correlation_clusters</span><span class="p">(</span><span class="n">flat_method</span><span class="o">=</span><span class="s1">&#39;silhouette&#39;</span><span class="p">,</span> <span class="n">max_clusters</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
</code></pre></div>
<img alt="Heatmap" src="../images/correlation_heatmap.png" />
<img alt="Silhouette Plot" src="../images/silhouette_plot.png" /></p>
<p>Finally, we visualise the structural relationships using a network plot. The different node colours represent different flattened hierarchical correlation clusters, while the edges between nodes identify their structural links. You can also save the network as an NX object and review in Cytoscape to get better insight on what these the structural relationship between individual features are (e.g. adduct links, isotopologues, cross-assay links).
<div class="highlight"><pre><span></span><code><span class="n">network</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">get_structural_network</span><span class="p">(</span><span class="n">include_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_nx_object</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<img alt="Network" src="../images/network.png" /></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>